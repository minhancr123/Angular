<div class="container-fluid mt-4">
  <!-- Header -->
  <mat-card class="header-card mb-4">
    <mat-card-header class="d-flex justify-content-between align-items-center">
      <div class="d-flex align-items-center me-auto">
        <button mat-icon-button (click)="goBack()" class="me-3">
          <mat-icon>arrow_back</mat-icon>
        </button>
        <div>
          <mat-card-title *ngIf="item">{{ item.TenMatHang }}</mat-card-title>
          <mat-card-subtitle *ngIf="item">Mã hàng: {{ item.MaHang }}</mat-card-subtitle>
        </div>
      </div>
      <!-- <div class="action-buttons">
        <button mat-raised-button color="primary" (click)="editItem()" *ngIf="item">
          <mat-icon>edit</mat-icon> Chỉnh sửa
        </button>
      </div> -->
    </mat-card-header>
  </mat-card>

  <!-- Loading -->
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Đang tải...</span>
    </div>
  </div>

  <!-- Content -->
  <div *ngIf="item && !loading">
    <mat-tab-group class="detail-tabs">
      <!-- Tab Thông tin cơ bản -->
      <mat-tab label="Thông tin cơ bản">
        <mat-card class="tab-card">
          <mat-card-content class="inventory-card-content">
            <div class="row">
              <div class="col-md-6 col-12">
                <div class="info-group mb-3">
                  <label class="info-label">Mã hàng:</label>
                  <span class="info-value">{{ item.MaHang }}</span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Tên mặt hàng:</label>
                  <span class="info-value">{{ item.TenMatHang }}</span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Mô tả:</label>
                  <span class="info-value">{{ item.MoTa || 'Không có' }}</span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Chi tiết mô tả:</label>
                  <span class="info-value">{{ item.ChiTietMoTa || 'Không có' }}</span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Tên OnSite:</label>
                  <span class="info-value">{{ item.TenOnSite || 'Không có' }}</span>
                </div>
              </div>
              <div class="col-md-6 col-12">
                <div class="info-group mb-3">
                  <label class="info-label">Giá mua:</label>
                  <span class="info-value text-success">{{ item.GiaMua | currency:'VND':'symbol':'1.0-0' }}</span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Giá bán:</label>
                  <span class="info-value text-primary">{{ item.GiaBan | currency:'VND':'symbol':'1.0-0' }}</span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">VAT:</label>
                  <span class="info-value">{{ item.Vat }}%</span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Barcode:</label>
                  <span class="info-value">{{ item.Barcode || 'Không có' }}</span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Trạng thái:</label>
                  <span class="info-value">
                    <span class="badge" [class]="item.NgungKinhDoanh ? 'badge-danger' : 'badge-success'">
                      {{ item.NgungKinhDoanh ? 'Ngừng kinh doanh' : 'Đang kinh doanh' }}
                    </span>
                  </span>
                </div>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </mat-tab>

      <!-- Tab Thông tin kỹ thuật -->
      <mat-tab label="Thông tin kỹ thuật">
        <mat-card class="tab-card">
          <mat-card-content class="inventory-card-content">
            <div class="row">
              <div class="col-md-6 col-12">
                <div class="info-group mb-3">
                  <label class="info-label">Quy đổi ĐVT cấp 2:</label>
                  <span class="info-value">{{ item.QuyDoiDVTCap2 || 0 }}</span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Quy đổi ĐVT cấp 3:</label>
                  <span class="info-value">{{ item.QuyDoiDVTCap3 || 0 }}</span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Kích thước:</label>
                  <span class="info-value">{{ item.KichThuoc || 'Không có' }}</span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Thông số:</label>
                  <span class="info-value">{{ item.ThongSo || 'Không có' }}</span>
                </div>
              </div>
              <div class="col-md-6 col-12">
                <div class="info-group mb-3">
                  <label class="info-label">Tồn tối thiểu:</label>
                  <span class="info-value">{{ item.LowerLimit || 0 }}</span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Tồn tối đa:</label>
                  <span class="info-value">{{ item.UpperLimit || 0 }}</span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Theo dõi tồn kho:</label>
                  <span class="info-value">
                    <mat-icon class="text-success" *ngIf="item.TheoDoiTonKho">check_circle</mat-icon>
                    <mat-icon class="text-danger" *ngIf="!item.TheoDoiTonKho">cancel</mat-icon>
                    {{ item.TheoDoiTonKho ? 'Có' : 'Không' }}
                  </span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Theo dõi lô:</label>
                  <span class="info-value">
                    <mat-icon class="text-success" *ngIf="item.TheoDoiLo">check_circle</mat-icon>
                    <mat-icon class="text-danger" *ngIf="!item.TheoDoiLo">cancel</mat-icon>
                    {{ item.TheoDoiLo ? 'Có' : 'Không' }}
                  </span>
                </div>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </mat-tab>

      <!-- Tab Tài sản -->
      <mat-tab label="Thông tin tài sản">
        <mat-card class="tab-card">
          <mat-card-content class="inventory-card-content">
            <div class="row">
              <div class="col-md-6 col-12">
                <div class="info-group mb-3">
                  <label class="info-label">Là tài sản:</label>
                  <span class="info-value">
                    <mat-icon class="text-success" *ngIf="item.IsTaiSan">check_circle</mat-icon>
                    <mat-icon class="text-danger" *ngIf="!item.IsTaiSan">cancel</mat-icon>
                    {{ item.IsTaiSan ? 'Có' : 'Không' }}
                  </span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Số kỳ khấu hao tối thiểu:</label>
                  <span class="info-value">{{ item.SoKyTinhKhauHaoToiThieu || 0 }}</span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Số kỳ khấu hao tối đa:</label>
                  <span class="info-value">{{ item.SoKyTinhKhauHaoToiDa || 0 }}</span>
                </div>
              </div>
              <div class="col-md-6 col-12">
                <div class="info-group mb-3">
                  <label class="info-label">Số năm đề nghị:</label>
                  <span class="info-value">{{ item.SoNamDeNghi || 'Không có' }}</span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Tỉ lệ hao mòn:</label>
                  <span class="info-value">{{ item.TiLeHaoMon || 'Không có' }}</span>
                </div>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </mat-tab>

      <!-- Tab Hình ảnh -->
      <mat-tab label="Hình ảnh">
        <mat-card class="tab-card">
          <mat-card-content class="inventory-card-content">
            <div class="image-section text-center">
              <h6 class="mb-4">Hình ảnh chính</h6>
              <div *ngIf="item.HinhAnh" class="image-container">
                <img [src]="item.HinhAnh" [alt]="item.TenMatHang" class="product-image" />
                <div class="image-info mt-3 inventory-pagination-responsive">
                  <small class="text-muted">{{ item.TenMatHang }}</small>
                </div>
              </div>
              <div *ngIf="!item.HinhAnh" class="no-image">
                <div class="no-image-placeholder">
                  <mat-icon class="large-icon">image_not_supported</mat-icon>
                  <p class="text-muted">Chưa có hình ảnh</p>
                </div>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </mat-tab>

      <!-- Tab Thông tin hệ thống -->
      <mat-tab label="Thông tin hệ thống">
        <mat-card class="tab-card">
          <mat-card-content class="inventory-card-content">
            <div class="row">
              <div class="col-md-6 col-12">
                <div class="info-group mb-3">
                  <label class="info-label">Ngày tạo:</label>
                  <span class="info-value">{{ item.CreatedDate | date:'dd/MM/yyyy HH:mm' }}</span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Người tạo:</label>
                  <span class="info-value">{{ item.CreatedBy || 'Không xác định' }}</span>
                </div>
              </div>
              <div class="col-md-6 col-12">
                <div class="info-group mb-3">
                  <label class="info-label">Ngày sửa đổi:</label>
                  <span class="info-value">{{ item.ModifiedDate ? (item.ModifiedDate | date:'dd/MM/yyyy HH:mm') : 'Chưa sửa đổi' }}
</span>
                </div>
                <div class="info-group mb-3">
                  <label class="info-label">Người sửa đổi:</label>
                  <span class="info-value">{{ item.ModifiedBy || 'Chưa có' }}</span>
                </div>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </mat-tab>
    </mat-tab-group>
  </div>

  <!-- Error state -->
  <div *ngIf="!item && !loading" class="text-center py-5">
    <mat-icon class="large-icon text-muted">error_outline</mat-icon>
    <h5 class="mt-3 inventory-pagination-responsive">Không tìm thấy thông tin mặt hàng</h5>
    <button mat-raised-button color="primary" (click)="goBack()" class="mt-3 inventory-pagination-responsive">
      <mat-icon>arrow_back</mat-icon> Quay lại danh sách
    </button>
  </div>
</div>
